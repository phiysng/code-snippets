## [位段](https://www.wikiwand.com/zh-cn/%E4%BD%8D%E6%AE%B5)

- 位段（或称“位域”，Bit field）为一种数据结构，可以把数据以位的形式紧凑的储存，并允许程序员对此结构的位进行操作。这种数据结构的好处：

    可以使数据单元节省储存空间，当程序需要成千上万个数据单元时，这种方法就显得尤为重要。
    位段可以很方便的访问一个整数值的部分内容从而可以简化程序源代码。

- 而位域这种数据结构的缺点在于，其内存分配与内存对齐的实现方式依赖于具体的机器和系统，在不同的平台可能有不同的结果，这导致了位段在本质上是不可移植的。[1] 

- ```
    struct CHAR 
    {
        unsigned int ch   : 8;    //8位
        unsigned int font : 6;    //6位
        unsigned int size : 18;   //18位
    };
    struct CHAR ch1;
    ```

    以下程序展示了一个结构体的声明： 

    ```
    struct CHAR2 
    {
        unsigned char ch;    //8位
        unsigned char font;  //8位
        unsigned int  size;  //32位
    };
    struct CHAR2 ch2;
    ```

    第一个声明取自一段文本格式化程序，应用了位段声明。它可以处理256个不同的字符（8位），64种不同字体（6位），以及最多262,144个单位的长度（18位）。这样，在ch1这个字段对象中，一共才占据了32位的空间。而第二个程序利用结构体进行声明，可以看出，处理相同的数据，CHAR2类型占用了48位空间，如果考虑边界对齐并把要求最严格的`int`类型最先声明进行优化，那么CHAR2类型则要占据64位的空间。 